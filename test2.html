<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Auto Música y Fondos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 50px;
      transition: background 0.5s;
      background-size: cover;
      background-position: center;
    }

    select, button {
      font-size: 16px;
      padding: 8px;
      margin: 10px;
      width: 250px;
    }
  </style>
</head>
<body>

  <h1>🎼 Página Musical y Visual</h1>

  <select id="bgSelector">
    <option value="">🌈 Selecciona un fondo</option>
    <option value="#ffffff">⬜ Blanco</option>
    <option value="#2ecc71">🍃 Verde</option>
    <option value="#3498db">🌊 Azul</option>
    <option value="img1">🖼️ Imagen Aleatoria</option>
    <option value="img2">🌄 Paisaje</option>
  </select>

  <br>

  <button id="musicToggle">🎶 Cambiar/Quitar Canción</button>

  <audio id="audioPlayer" autoplay loop></audio>

  <script>
    const audioPlayer = document.getElementById('audioPlayer');
    const musicToggle = document.getElementById('musicToggle');
    const songs = [
      "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
      "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
      "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
    ];
    let currentSong = 0;

    // Función para cargar canción
    function loadSong(index) {
      audioPlayer.src = songs[index];
      audioPlayer.play().catch(() => {
        console.log("El navegador bloqueó la reproducción automática.");
      });
      localStorage.setItem("lastSong", index);
    }

    // Cargar última canción usada
    window.addEventListener('load', () => {
      const savedSong = localStorage.getItem("lastSong");
      if (savedSong !== null) {
        currentSong = parseInt(savedSong);
      }
      loadSong(currentSong);

      const savedBg = localStorage.getItem("bg");
      if (savedBg) {
        applyBackground(savedBg);
        document.getElementById("bgSelector").value = savedBg;
      }
    });

    // Cambiar o pausar canción
    musicToggle.addEventListener('click', () => {
      if (!audioPlayer.paused) {
        audioPlayer.pause();
        musicToggle.textContent = "▶️ Reanudar Música";
      } else {
        currentSong = (currentSong + 1) % songs.length;
        loadSong(currentSong);
        musicToggle.textContent = "🎶 Cambiar/Quitar Canción";
      }
    });

    // Cambiar fondo
    const bgSelector = document.getElementById("bgSelector");

    bgSelector.addEventListener("change", () => {
      const value = bgSelector.value;
      applyBackground(value);
      localStorage.setItem("bg", value);
    });

    function applyBackground(value) {
      document.body.style.backgroundImage = '';
      if (value.startsWith("#")) {
        document.body.style.background = value;
      } else if (value === "img1") {
        const url = `https://source.unsplash.com/random/1600x900?sig=${Math.floor(Math.random() * 1000)}`;
        document.body.style.backgroundImage = `url(${url})`;
        document.body.style.background = "none";
      } else if (value === "img2") {
        document.body.style.backgroundImage = "url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80')";
        document.body.style.background = "none";
      } else {
        document.body.style.background = "#ffffff";
      }
    }
  </script>

</body>
</html>
