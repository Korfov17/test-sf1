<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Reparaci√≥n - TecnoRepair Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.js"></script>
    <style>
        :root {
            --primary-color: #8a2be2;
            --secondary-color: #5e17eb;
            --accent-color: #ff6b6b;
            --dark-color: #121212;
            --darker-color: #0a0a0a;
            --light-color: #f8f9fa;
            --lighter-color: #ffffff;
            --text-gradient: linear-gradient(90deg, #8a2be2, #5e17eb, #ff6b6b);
            --card-bg: rgba(30, 30, 30, 0.7);
            --card-border: 1px solid rgba(255, 255, 255, 0.1);
            --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --glow-effect: 0 0 15px rgba(138, 43, 226, 0.5);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark-color);
            color: var(--light-color);
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(138, 43, 226, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(94, 23, 235, 0.1) 0%, transparent 20%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 0;
            text-align: center;
            border-radius: 12px 12px 0 0;
            margin-bottom: 30px;
            box-shadow: var(--glow-effect);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tecno-text {
            font-size: 2.8rem;
            margin-bottom: 10px;
            position: relative;
            background: var(--text-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            font-weight: bold;
            font-style: italic;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            position: relative;
        }
        
        .form-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            border: var(--card-border);
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-section h2 {
            background: var(--text-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 20px;
            font-size: 1.8rem;
            position: relative;
            display: inline-block;
        }
        
        .form-section h2::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--text-gradient);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 250px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--light-color);
            font-size: 1.1rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px;
            background-color: rgba(20, 20, 20, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--light-color);
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.3);
            background-color: rgba(30, 30, 30, 0.9);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .radio-group, .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .radio-option, .checkbox-option {
            display: flex;
            align-items: center;
            background: rgba(30, 30, 30, 0.7);
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }
        
        .radio-option:hover, .checkbox-option:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.3);
        }
        
        .radio-option input, .checkbox-option input {
            width: auto;
            margin-right: 10px;
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.4);
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: all 0.5s;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.6);
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn-accent {
            background: linear-gradient(135deg, var(--accent-color), #ff8e8e);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }
        
        .btn-accent:hover {
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
        }
        
        .btn-success:hover {
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.6);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            animation: modalFadeIn 0.4s;
            border: var(--card-border);
            box-shadow: var(--card-shadow);
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal h2 {
            margin-bottom: 20px;
            font-size: 1.8rem;
            background: var(--text-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .modal p {
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .equipment-photo {
            width: 180px;
            height: 180px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s;
            background-color: rgba(20, 20, 20, 0.5);
        }
        
        .equipment-photo:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
        }
        
        .equipment-photo img {
            max-width: 100%;
            max-height: 100%;
            display: none;
            object-fit: contain;
        }
        
        .photo-placeholder {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            padding: 20px;
        }
        
        .photo-placeholder i {
            font-size: 50px;
            margin-bottom: 15px;
            display: block;
            color: var(--primary-color);
        }
        
        .signature-pad {
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            margin-bottom: 15px;
            background-color: rgba(20, 20, 20, 0.5);
        }
        
        .signature-clear {
            background-color: rgba(30, 30, 30, 0.7);
            color: var(--light-color);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
        }
        
        .signature-clear:hover {
            background-color: rgba(40, 40, 40, 0.7);
            border-color: var(--accent-color);
        }
        
        .software-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .software-category {
            background: rgba(30, 30, 30, 0.7);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .software-category h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .software-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .software-item input {
            width: auto;
            margin-right: 10px;
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 20px;
            }
            
            .tecno-text {
                font-size: 2.2rem;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 15px;
            }
            
            .software-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="tecno-text">TecnoRepair Pro</div>
            <p>Formulario avanzado de recepci√≥n de equipos</p>
        </header>
        
        <div class="form-container">
            <form id="repairForm">
                <!-- Secci√≥n de informaci√≥n del cliente -->
                <div class="form-section">
                    <h2>Informaci√≥n del Cliente</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName">Nombre completo*</label>
                            <input type="text" id="clientName" name="clientName" required>
                        </div>
                        <div class="form-group">
                            <label for="clientEmail">Correo electr√≥nico*</label>
                            <input type="email" id="clientEmail" name="clientEmail" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientPhone">Tel√©fono*</label>
                            <input type="tel" id="clientPhone" name="clientPhone" required>
                        </div>
                        <div class="form-group">
                            <label for="clientId">Identificaci√≥n (DNI/CIF/NIE)</label>
                            <input type="text" id="clientId" name="clientId">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="clientAddress">Direcci√≥n</label>
                        <input type="text" id="clientAddress" name="clientAddress">
                    </div>
                </div>
                
                <!-- Secci√≥n de informaci√≥n del equipo -->
                <div class="form-section">
                    <h2>Informaci√≥n del Equipo</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="equipmentType">Tipo de equipo*</label>
                            <select id="equipmentType" name="equipmentType" required>
                                <option value="" selected disabled>Seleccione...</option>
                                <option value="laptop">Port√°til/Laptop</option>
                                <option value="desktop">Ordenador de sobremesa</option>
                                <option value="tablet">Tablet</option>
                                <option value="smartphone">Smartphone</option>
                                <option value="printer">Impresora</option>
                                <option value="monitor">Monitor</option>
                                <option value="server">Servidor</option>
                                <option value="network">Equipo de red</option>
                                <option value="other">Otro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="equipmentBrand">Marca*</label>
                            <input type="text" id="equipmentBrand" name="equipmentBrand" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="equipmentModel">Modelo*</label>
                            <input type="text" id="equipmentModel" name="equipmentModel" required>
                        </div>
                        <div class="form-group">
                            <label for="serialNumber">N√∫mero de serie</label>
                            <input type="text" id="serialNumber" name="serialNumber">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="purchaseDate">Fecha de compra (aproximada)</label>
                            <input type="date" id="purchaseDate" name="purchaseDate">
                        </div>
                        <div class="form-group">
                            <label for="warranty">¬øEn garant√≠a?</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="warrantyYes" name="warranty" value="S√≠">
                                    <label for="warrantyYes">S√≠</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="warrantyNo" name="warranty" value="No">
                                    <label for="warrantyNo">No</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="operatingSystem">Sistema operativo*</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="osWindows" name="operatingSystem" value="Windows">
                                <label for="osWindows">Windows</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="osLinux" name="operatingSystem" value="Linux">
                                <label for="osLinux">Linux</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="osMac" name="operatingSystem" value="macOS">
                                <label for="osMac">macOS</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="osOther" name="operatingSystem" value="Otro">
                                <label for="osOther">Otro</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="osVersion">Versi√≥n del sistema operativo</label>
                        <input type="text" id="osVersion" name="osVersion" placeholder="Ej: Windows 10 Pro, Ubuntu 22.04, etc.">
                    </div>
                    <div class="form-group">
                        <label for="equipmentCondition">Estado f√≠sico del equipo*</label>
                        <textarea id="equipmentCondition" name="equipmentCondition" required placeholder="Describa el estado f√≠sico del equipo (golpes, rayones, piezas faltantes, l√≠quidos derramados, etc.)"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Fotograf√≠a del equipo</label>
                        <div class="equipment-photo" id="photoContainer">
                            <div class="photo-placeholder">
                                <div>üì∑</div>
                                <span>Haga clic para agregar foto</span>
                            </div>
                            <img id="equipmentPhoto" src="" alt="Foto del equipo">
                        </div>
                        <input type="file" id="photoInput" accept="image/*" style="display: none;">
                    </div>
                </div>
                
                <!-- Secci√≥n ampliada de software y servicios -->
                <div class="form-section">
                    <h2>Software y Servicios</h2>
                    <div class="form-group">
                        <label>Seleccione el software a instalar:</label>
                        <div class="software-options">
                            <!-- Ofim√°tica -->
                            <div class="software-category">
                                <h4>Ofim√°tica</h4>
                                <div class="software-item">
                                    <input type="checkbox" id="office" name="office">
                                    <label for="office">Microsoft Office</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="libreoffice" name="libreoffice">
                                    <label for="libreoffice">LibreOffice</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="googleWorkspace" name="googleWorkspace">
                                    <label for="googleWorkspace">Google Workspace</label>
                                </div>
                            </div>
                            
                            <!-- Seguridad -->
                            <div class="software-category">
                                <h4>Seguridad</h4>
                                <div class="software-item">
                                    <input type="checkbox" id="antivirus" name="antivirus">
                                    <label for="antivirus">Antivirus</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="vpn" name="vpn">
                                    <label for="vpn">VPN</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="firewall" name="firewall">
                                    <label for="firewall">Firewall</label>
                                </div>
                            </div>
                            
                            <!-- Dise√±o y Multimedia -->
                            <div class="software-category">
                                <h4>Dise√±o y Multimedia</h4>
                                <div class="software-item">
                                    <input type="checkbox" id="adobe" name="adobe">
                                    <label for="adobe">Adobe Creative Cloud</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="autocad" name="autocad">
                                    <label for="autocad">AutoCAD</label>
                                </div>
                            </div>
                            
                            <!-- Desarrollo -->
                            <div class="software-category">
                                <h4>Desarrollo</h4>
                                <div class="software-item">
                                    <input type="checkbox" id="vscode" name="vscode">
                                    <label for="vscode">Visual Studio Code</label>
                                </div>
                                <div class="software-item">
                                    <input type="checkbox" id="git" name="git">
                                    <label for="git">Git</label>
                                </div>
                            </div>
                            
                            <!-- Personalizado -->
                            <div class="software-category">
                                <h4>Personalizado</h4>
                                <div class="software-item">
                                    <input type="checkbox" id="customSoftware" name="customSoftware">
                                    <label for="customSoftware">Software personalizado</label>
                                </div>
                                <textarea id="customSoftwareList" name="customSoftwareList" placeholder="Especifique el software personalizado" style="margin-top: 10px; display: none;"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="backupRequired">¬øRequiere backup de datos?</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="backupYes" name="backupRequired" value="S√≠">
                                <label for="backupYes">S√≠</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="backupNo" name="backupRequired" value="No">
                                <label for="backupNo">No</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" id="backupDetailsGroup" style="display: none;">
                        <label for="backupDetails">Detalles del backup</label>
                        <textarea id="backupDetails" name="backupDetails" placeholder="Especifique qu√© datos necesita respaldar y ubicaci√≥n aproximada"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="dataRecovery">¬øRequiere recuperaci√≥n de datos?</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="recoveryYes" name="dataRecovery" value="S√≠">
                                <label for="recoveryYes">S√≠</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="recoveryNo" name="dataRecovery" value="No">
                                <label for="recoveryNo">No</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Secci√≥n de descripci√≥n del problema -->
                <div class="form-section">
                    <h2>Descripci√≥n del Problema</h2>
                    <div class="form-group">
                        <label for="problemDescription">Descripci√≥n detallada del problema*</label>
                        <textarea id="problemDescription" name="problemDescription" required placeholder="Describa con el mayor detalle posible qu√© problema presenta el equipo, cu√°ndo comenz√≥, qu√© ha intentado para solucionarlo, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="errorMessages">Mensajes de error (si aplica)</label>
                        <textarea id="errorMessages" name="errorMessages" placeholder="Escriba los mensajes de error exactos que muestra el equipo, si los hay"></textarea>
                    </div>
                    <div class="form-group">
                        <label>¬øQu√© componentes/software incluye?</label>
                        <div class="checkbox-group">
                            <div class="checkbox-option">
                                <input type="checkbox" id="includesCharger" name="includesCharger">
                                <label for="includesCharger">Cargador</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="includesBattery" name="includesBattery">
                                <label for="includesBattery">Bater√≠a</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="includesCase" name="includesCase">
                                <label for="includesCase">Funda/carcasa</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Secci√≥n de firma -->
                <div class="form-section">
                    <h2>Confirmaci√≥n</h2>
                    <div class="form-group">
                        <label for="clientSignature">Firma del cliente*</label>
                        <div id="signaturePad" class="signature-pad" style="width: 100%; height: 150px;"></div>
                        <button type="button" id="clearSignature" class="btn signature-clear">Limpiar firma</button>
                        <input type="hidden" id="clientSignature" name="clientSignature" required>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-accent btn-block">Generar documento de recepci√≥n</button>
            </form>
        </div>
    </div>
    
    <!-- Modal para seleccionar formato de descarga -->
    <div id="downloadModal" class="modal">
        <div class="modal-content">
            <h2>Documento generado con √©xito</h2>
            <p>Seleccione el formato en el que desea descargar el documento de recepci√≥n:</p>
            <div class="modal-buttons">
                <button id="downloadPdf" class="btn btn-accent">Descargar PDF</button>
                <button id="downloadDocx" class="btn btn-success">Descargar DOCX</button>
            </div>
        </div>
    </div>
    
    <footer>
        <p>TecnoRepair Pro &copy; 2023 - Soluciones tecnol√≥gicas avanzadas</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
    <script>
        // Inicializar el pad de firma
        const canvas = document.createElement('canvas');
        canvas.width = document.getElementById('signaturePad').offsetWidth;
        canvas.height = 150;
        document.getElementById('signaturePad').appendChild(canvas);
        
        const signaturePad = new SignaturePad(canvas, {
            backgroundColor: 'rgba(20, 20, 20, 0)',
            penColor: 'rgb(255, 255, 255)'
        });
        
        document.getElementById('clearSignature').addEventListener('click', function() {
            signaturePad.clear();
            document.getElementById('clientSignature').value = '';
        });
        
        // Manejar cambios en el pad de firma
        canvas.addEventListener('mouseup', updateSignatureValue);
        canvas.addEventListener('touchend', updateSignatureValue);
        
        function updateSignatureValue() {
            if (!signaturePad.isEmpty()) {
                document.getElementById('clientSignature').value = signaturePad.toDataURL();
            } else {
                document.getElementById('clientSignature').value = '';
            }
        }
        
        // Manejar la subida de fotos
        document.getElementById('photoContainer').addEventListener('click', function() {
            document.getElementById('photoInput').click();
        });
        
        document.getElementById('photoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('equipmentPhoto');
                    img.src = event.target.result;
                    img.style.display = 'block';
                    document.querySelector('.photo-placeholder').style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        });
        
        // Mostrar/ocultar detalles de backup
        document.querySelectorAll('input[name="backupRequired"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.getElementById('backupDetailsGroup').style.display = 
                    this.value === 'S√≠' ? 'block' : 'none';
            });
        });
        
        // Mostrar/ocultar campo de software personalizado
        document.getElementById('customSoftware').addEventListener('change', function() {
            document.getElementById('customSoftwareList').style.display = 
                this.checked ? 'block' : 'none';
        });
        
        // Manejar el env√≠o del formulario
        document.getElementById('repairForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validar firma
            if (signaturePad.isEmpty()) {
                alert('Por favor, proporcione su firma');
                return;
            }
            
            // Mostrar modal de descarga
            document.getElementById('downloadModal').style.display = 'flex';
        });
        
        // Configurar botones de descarga
        document.getElementById('downloadPdf').addEventListener('click', function() {
            generatePdf();
            resetForm();
        });
        
        document.getElementById('downloadDocx').addEventListener('click', function() {
            generateDocx();
            resetForm();
        });
        
        // Cerrar modal al hacer clic fuera
        document.getElementById('downloadModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // Funci√≥n para resetear el formulario
        function resetForm() {
            document.getElementById('repairForm').reset();
            signaturePad.clear();
            document.getElementById('clientSignature').value = '';
            document.getElementById('equipmentPhoto').style.display = 'none';
            document.querySelector('.photo-placeholder').style.display = 'block';
            document.getElementById('photoInput').value = '';
            document.getElementById('backupDetailsGroup').style.display = 'none';
            document.getElementById('customSoftwareList').style.display = 'none';
            document.getElementById('downloadModal').style.display = 'none';
        }
        
        // Funci√≥n para generar PDF (formato blanco)
        function generatePdf() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configuraci√≥n inicial
            doc.setFont('helvetica');
            doc.setFontSize(22);
            doc.setTextColor(0, 0, 0);
            doc.text('TecnoRepair Pro', 105, 20, { align: 'center' });
            doc.setFontSize(16);
            doc.text('DOCUMENTO DE RECEPCI√ìN DE EQUIPO', 105, 30, { align: 'center' });
            
            // Fecha y n√∫mero de ticket
            const now = new Date();
            doc.setFontSize(10);
            doc.text(`Fecha: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`, 14, 40);
            doc.text(`Ticket #${Math.floor(10000 + Math.random() * 90000)}`, 186, 40, { align: 'right' });
            
            // L√≠nea separadora
            doc.setDrawColor(0, 0, 0);
            doc.setLineWidth(0.5);
            doc.line(14, 45, 196, 45);
            
            // Informaci√≥n del cliente
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('INFORMACI√ìN DEL CLIENTE', 14, 55);
            doc.setFont('helvetica', 'normal');
            
            let y = 65;
            doc.text(`Nombre: ${document.getElementById('clientName').value}`, 14, y);
            y += 7;
            doc.text(`Correo: ${document.getElementById('clientEmail').value}`, 14, y);
            y += 7;
            doc.text(`Tel√©fono: ${document.getElementById('clientPhone').value}`, 14, y);
            y += 7;
            doc.text(`Identificaci√≥n: ${document.getElementById('clientId').value || 'No proporcionada'}`, 14, y);
            y += 7;
            doc.text(`Direcci√≥n: ${document.getElementById('clientAddress').value || 'No proporcionada'}`, 14, y);
            y += 12;
            
            // Informaci√≥n del equipo
            doc.setFont('helvetica', 'bold');
            doc.text('INFORMACI√ìN DEL EQUIPO', 14, y);
            doc.setFont('helvetica', 'normal');
            y += 7;
            
            doc.text(`Tipo: ${document.getElementById('equipmentType').value}`, 14, y);
            y += 7;
            doc.text(`Marca: ${document.getElementById('equipmentBrand').value}`, 14, y);
            y += 7;
            doc.text(`Modelo: ${document.getElementById('equipmentModel').value}`, 14, y);
            y += 7;
            doc.text(`N√∫mero de serie: ${document.getElementById('serialNumber').value || 'No proporcionado'}`, 14, y);
            y += 7;
            doc.text(`Fecha compra: ${document.getElementById('purchaseDate').value || 'No proporcionada'}`, 14, y);
            y += 7;
            doc.text(`Garant√≠a: ${document.querySelector('input[name="warranty"]:checked')?.value || 'No especificado'}`, 14, y);
            y += 7;
            doc.text(`Sistema operativo: ${document.querySelector('input[name="operatingSystem"]:checked')?.value || 'No especificado'} ${document.getElementById('osVersion').value || ''}`, 14, y);
            y += 7;
            
            // Estado del equipo (puede ser multil√≠nea)
            const conditionLines = doc.splitTextToSize(
                `Estado f√≠sico: ${document.getElementById('equipmentCondition').value}`, 
                180
            );
            doc.text(conditionLines, 14, y);
            y += conditionLines.length * 7;
            
            // Componentes incluidos
            const includes = [];
            if (document.getElementById('includesCharger').checked) includes.push('Cargador');
            if (document.getElementById('includesBattery').checked) includes.push('Bater√≠a');
            if (document.getElementById('includesCase').checked) includes.push('Funda/carcasa');
            
            doc.text(`Componentes incluidos: ${includes.join(', ') || 'Ninguno especificado'}`, 14, y);
            y += 12;
            
            // Software a instalar
            const softwareToInstall = [];
            if (document.getElementById('office').checked) softwareToInstall.push('Microsoft Office');
            if (document.getElementById('libreoffice').checked) softwareToInstall.push('LibreOffice');
            if (document.getElementById('googleWorkspace').checked) softwareToInstall.push('Google Workspace');
            if (document.getElementById('antivirus').checked) softwareToInstall.push('Antivirus');
            if (document.getElementById('vpn').checked) softwareToInstall.push('VPN');
            if (document.getElementById('firewall').checked) softwareToInstall.push('Firewall');
            if (document.getElementById('adobe').checked) softwareToInstall.push('Adobe Creative Cloud');
            if (document.getElementById('autocad').checked) softwareToInstall.push('AutoCAD');
            if (document.getElementById('vscode').checked) softwareToInstall.push('VS Code');
            if (document.getElementById('git').checked) softwareToInstall.push('Git');
            if (document.getElementById('customSoftware').checked) {
                softwareToInstall.push('Software personalizado: ' + document.getElementById('customSoftwareList').value);
            }
            
            if (softwareToInstall.length > 0) {
                doc.text('Software a instalar:', 14, y);
                y += 7;
                
                const softwareLines = doc.splitTextToSize(
                    softwareToInstall.join(', '), 
                    180
                );
                doc.text(softwareLines, 20, y);
                y += softwareLines.length * 7;
                y += 5;
            }
            
            // Servicios adicionales
            if (document.getElementById('backupYes').checked) {
                doc.text(`Backup requerido: S√≠ - ${document.getElementById('backupDetails').value || 'Sin detalles'}`, 14, y);
                y += 7;
            }
            
            if (document.getElementById('recoveryYes').checked) {
                doc.text('Recuperaci√≥n de datos requerida: S√≠', 14, y);
                y += 7;
            }
            
            y += 5;
            
            // Descripci√≥n del problema
            doc.setFont('helvetica', 'bold');
            doc.text('DESCRIPCI√ìN DEL PROBLEMA', 14, y);
            doc.setFont('helvetica', 'normal');
            y += 7;
            
            const problemLines = doc.splitTextToSize(
                document.getElementById('problemDescription').value, 
                180
            );
            doc.text(problemLines, 14, y);
            y += problemLines.length * 7;
            
            if (document.getElementById('errorMessages').value) {
                y += 5;
                doc.text('Mensajes de error:', 14, y);
                y += 7;
                
                const errorLines = doc.splitTextToSize(
                    document.getElementById('errorMessages').value, 
                    180
                );
                doc.text(errorLines, 20, y);
                y += errorLines.length * 7;
            }
            
            y += 12;
            
            // Firma
            doc.text('Firma del cliente:', 14, y);
            
            try {
                const signatureData = document.getElementById('clientSignature').value;
                if (signatureData) {
                    doc.addImage(signatureData, 'PNG', 14, y + 5, 60, 20);
                }
            } catch (e) {
                console.error('Error al agregar la firma:', e);
            }
            
            // Foto del equipo (si existe)
            const photoInput = document.getElementById('photoInput');
            if (photoInput.files && photoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        doc.addPage();
                        
                        doc.setFont('helvetica', 'bold');
                        doc.text('FOTOGRAF√çA DEL EQUIPO', 105, 20, { align: 'center' });
                        doc.setFont('helvetica', 'normal');
                        
                        // Ajustar la imagen al ancho de la p√°gina manteniendo la relaci√≥n de aspecto
                        const img = new Image();
                        img.src = event.target.result;
                        
                        img.onload = function() {
                            const ratio = img.width / img.height;
                            let width = 180;
                            let height = width / ratio;
                            
                            if (height > 150) {
                                height = 150;
                                width = height * ratio;
                            }
                            
                            doc.addImage(img, 'JPEG', (210 - width) / 2, 30, width, height);
                            
                            // Pie de p√°gina
                            doc.setFontSize(10);
                            doc.text('TecnoRepair Pro - Soluciones tecnol√≥gicas avanzadas', 105, 280, { align: 'center' });
                            
                            doc.save('recepcion_equipo_tecno.pdf');
                        };
                    } catch (e) {
                        console.error('Error al agregar la foto:', e);
                        doc.save('recepcion_equipo_tecno.pdf');
                    }
                };
                reader.readAsDataURL(photoInput.files[0]);
            } else {
                // Pie de p√°gina si no hay foto
                doc.setFontSize(10);
                doc.text('TecnoRepair Pro - Soluciones tecnol√≥gicas avanzadas', 105, 280, { align: 'center' });
                
                doc.save('recepcion_equipo_tecno.pdf');
            }
        }
        
        // Funci√≥n para generar DOCX (formato blanco)
        function generateDocx() {
            const { Document, Paragraph, TextRun, HeadingLevel, Packer, Table, TableRow, TableCell, WidthType, AlignmentType } = docx;
            
            // Obtener software a instalar
            const softwareToInstall = [];
            if (document.getElementById('office').checked) softwareToInstall.push('Microsoft Office');
            if (document.getElementById('libreoffice').checked) softwareToInstall.push('LibreOffice');
            if (document.getElementById('googleWorkspace').checked) softwareToInstall.push('Google Workspace');
            if (document.getElementById('antivirus').checked) softwareToInstall.push('Antivirus');
            if (document.getElementById('vpn').checked) softwareToInstall.push('VPN');
            if (document.getElementById('firewall').checked) softwareToInstall.push('Firewall');
            if (document.getElementById('adobe').checked) softwareToInstall.push('Adobe Creative Cloud');
            if (document.getElementById('autocad').checked) softwareToInstall.push('AutoCAD');
            if (document.getElementById('vscode').checked) softwareToInstall.push('VS Code');
            if (document.getElementById('git').checked) softwareToInstall.push('Git');
            if (document.getElementById('customSoftware').checked) {
                softwareToInstall.push('Software personalizado: ' + document.getElementById('customSoftwareList').value);
            }
            
            // Obtener componentes incluidos
            const includes = [];
            if (document.getElementById('includesCharger').checked) includes.push('Cargador');
            if (document.getElementById('includesBattery').checked) includes.push('Bater√≠a');
            if (document.getElementById('includesCase').checked) includes.push('Funda/carcasa');
            
            // Crear el documento
            const doc = new Document({
                sections: [{
                    properties: {
                        page: {
                            margin: {
                                top: 1000,
                                right: 1000,
                                bottom: 1000,
                                left: 1000
                            }
                        }
                    },
                    children: [
                        // Encabezado
                        new Paragraph({
                            text: "TecnoRepair Pro",
                            heading: HeadingLevel.HEADING_1,
                            alignment: AlignmentType.CENTER,
                            spacing: { after: 200 },
                            border: { bottom: { color: "000000", size: 8, style: "single" } }
                        }),
                        new Paragraph({
                            text: "DOCUMENTO DE RECEPCI√ìN DE EQUIPO",
                            heading: HeadingLevel.HEADING_2,
                            alignment: AlignmentType.CENTER,
                            spacing: { after: 300 }
                        }),
                        
                        // Informaci√≥n del ticket
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: `Ticket #${Math.floor(10000 + Math.random() * 90000)}`,
                                    bold: true
                                }),
                                new TextRun({
                                    text: `\tFecha: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`,
                                    bold: true
                                })
                            ],
                            spacing: { after: 400 }
                        }),
                        
                        // Informaci√≥n del cliente
                        new Paragraph({
                            text: "INFORMACI√ìN DEL CLIENTE",
                            heading: HeadingLevel.HEADING_3,
                            spacing: { before: 400, after: 200 }
                        }),
                        createInfoTable([
                            ["Nombre", document.getElementById('clientName').value],
                            ["Correo electr√≥nico", document.getElementById('clientEmail').value],
                            ["Tel√©fono", document.getElementById('clientPhone').value],
                            ["Identificaci√≥n", document.getElementById('clientId').value || "No proporcionada"],
                            ["Direcci√≥n", document.getElementById('clientAddress').value || "No proporcionada"]
                        ]),
                        
                        // Informaci√≥n del equipo
                        new Paragraph({
                            text: "INFORMACI√ìN DEL EQUIPO",
                            heading: HeadingLevel.HEADING_3,
                            spacing: { before: 400, after: 200 }
                        }),
                        createInfoTable([
                            ["Tipo de equipo", document.getElementById('equipmentType').value],
                            ["Marca", document.getElementById('equipmentBrand').value],
                            ["Modelo", document.getElementById('equipmentModel').value],
                            ["N√∫mero de serie", document.getElementById('serialNumber').value || "No proporcionado"],
                            ["Fecha de compra", document.getElementById('purchaseDate').value || "No proporcionada"],
                            ["En garant√≠a", document.querySelector('input[name="warranty"]:checked')?.value || "No especificado"],
                            ["Sistema operativo", `${document.querySelector('input[name="operatingSystem"]:checked')?.value || "No especificado"} ${document.getElementById('osVersion').value || ''}`],
                            ["Estado f√≠sico", document.getElementById('equipmentCondition').value],
                            ["Componentes incluidos", includes.join(', ') || "Ninguno especificado"]
                        ]),
                        
                        // Software a instalar (si hay)
                        softwareToInstall.length > 0 ? new Paragraph({
                            text: "SOFTWARE A INSTALAR",
                            heading: HeadingLevel.HEADING_4,
                            spacing: { before: 400, after: 200 }
                        }) : null,
                        softwareToInstall.length > 0 ? new Paragraph({
                            children: [new TextRun(softwareToInstall.join(', '))],
                            spacing: { after: 200 }
                        }) : null,
                        
                        // Servicios adicionales
                        new Paragraph({
                            text: "SERVICIOS ADICIONALES",
                            heading: HeadingLevel.HEADING_4,
                            spacing: { before: 400, after: 200 }
                        }),
                        createInfoTable([
                            ["Backup de datos", document.getElementById('backupYes').checked ? 
                                `S√≠ - ${document.getElementById('backupDetails').value || 'Sin detalles'}` : "No"],
                            ["Recuperaci√≥n de datos", document.getElementById('recoveryYes').checked ? "S√≠" : "No"]
                        ]),
                        
                        // Descripci√≥n del problema
                        new Paragraph({
                            text: "DESCRIPCI√ìN DEL PROBLEMA",
                            heading: HeadingLevel.HEADING_3,
                            spacing: { before: 400, after: 200 }
                        }),
                        new Paragraph({
                            children: [new TextRun(document.getElementById('problemDescription').value)],
                            spacing: { after: 200 }
                        }),
                        
                        // Mensajes de error (si existen)
                        document.getElementById('errorMessages').value ? new Paragraph({
                            text: "MENSAJES DE ERROR:",
                            heading: HeadingLevel.HEADING_4,
                            spacing: { before: 200, after: 100 }
                        }) : null,
                        document.getElementById('errorMessages').value ? new Paragraph({
                            children: [new TextRun(document.getElementById('errorMessages').value)],
                            spacing: { after: 200 }
                        }) : null,
                        
                        // Firma
                        new Paragraph({
                            text: "FIRMA DEL CLIENTE",
                            heading: HeadingLevel.HEADING_4,
                            spacing: { before: 400, after: 200 }
                        }),
                        new Paragraph({
                            text: "Firma recibida electr√≥nicamente",
                            italics: true,
                            spacing: { after: 400 }
                        }),
                        
                        // Pie de p√°gina
                        new Paragraph({
                            text: "TecnoRepair Pro - Soluciones tecnol√≥gicas avanzadas",
                            alignment: AlignmentType.CENTER,
                            spacing: { before: 800 },
                            border: { top: { color: "000000", size: 8, style: "single" } }
                        })
                    ].filter(Boolean) // Eliminar elementos nulos
                }]
            });
            
            // Generar y descargar el documento
            Packer.toBlob(doc).then(blob => {
                saveAs(blob, "recepcion_equipo_tecno.docx");
            });
            
            function createInfoTable(rows) {
                return new Table({
                    rows: rows.map(row => new TableRow({
                        children: [
                            new TableCell({
                                children: [new Paragraph({
                                    children: [new TextRun({
                                        text: row[0],
                                        bold: true
                                    })],
                                    alignment: AlignmentType.LEFT
                                })],
                                width: { size: 30, type: WidthType.PERCENTAGE }
                            }),
                            new TableCell({
                                children: [new Paragraph({
                                    children: [new TextRun(row[1])],
                                    alignment: AlignmentType.LEFT
                                })],
                                width: { size: 70, type: WidthType.PERCENTAGE }
                            })
                        ]
                    })),
                    width: { size: 100, type: WidthType.PERCENTAGE },
                    borders: {
                        top: { style: "single", size: 6, color: "000000" },
                        bottom: { style: "single", size: 6, color: "000000" },
                        left: { style: "single", size: 6, color: "000000" },
                        right: { style: "single", size: 6, color: "000000" },
                        insideHorizontal: { style: "single", size: 2, color: "AAAAAA" },
                        insideVertical: { style: "single", size: 2, color: "AAAAAA" }
                    }
                });
            }
        }
        
        // Funci√≥n auxiliar para guardar el blob
        function saveAs(blob, fileName) {
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
