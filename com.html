<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Compartir y Enviar (Gmail shortcut)</title>
  <style>
    :root{
      --bg1:#6a11cb; --bg2:#2575fc; --card: rgba(255,255,255,0.08);
      --accent:#ff9800; --ok:#bff0c6; --err:#ffb4b4;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
      color:#fff;
      padding:20px;
    }
    .card{
      width:100%;
      max-width:760px;
      background:var(--card);
      border-radius:var(--radius);
      padding:22px;
      box-shadow:0 12px 30px rgba(0,0,0,0.35);
      backdrop-filter: blur(6px);
    }
    h1{margin:0 0 10px 0; font-size:20px; text-align:center}
    .row{display:flex; gap:18px; align-items:flex-start; flex-wrap:wrap}
    .col{flex:1 1 320px}
    .share-box, .form-box{
      background: rgba(255,255,255,0.03);
      padding:14px; border-radius:10px;
    }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      border:0; padding:12px 14px; border-radius:10px; font-weight:700;
      cursor:pointer; transition: transform .14s ease, box-shadow .14s ease;
      box-shadow: 0 8px 18px rgba(0,0,0,0.2);
      width:100%;
    }
    .btn:hover{transform:translateY(-4px)}
    .whatsapp{background:#25d366; color:#fff}
    .telegram{background:#0088cc; color:#fff}
    .send{background:var(--accent); color:#111}

    label{display:block; font-size:13px; margin-bottom:6px; color:rgba(255,255,255,0.9)}
    textarea, input[type="text"]{
      width:100%; padding:10px 12px; border-radius:8px; border:0; outline:none;
      background: rgba(255,255,255,0.04); color:#fff; font-size:14px; resize:vertical;
    }

    .meta{font-size:13px; color:rgba(255,255,255,0.8)}
    .note{font-size:13px; color:rgba(255,255,255,0.7); margin-top:8px}
    .status { margin-top:10px; font-size:13px; }
    .status.ok { color: var(--ok) }
    .status.err { color: var(--err) }

    @media (max-width:700px){
      .row{flex-direction:column}
    }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <h1 id="title">Compartir y Enviar (atajo Gmail)</h1>

    <div class="row">
      <!-- SHARE -->
      <div class="col share-box" aria-labelledby="shareTitle">
        <h2 id="shareTitle" style="margin:0 0 10px 0;font-size:16px">Compartir (mensaje largo)</h2>
        <p class="meta">El botón abrirá la app correspondiente con el asunto y mensaje predefinidos.</p>

        <div style="display:flex;flex-direction:column;gap:10px;margin-top:8px">
          <a id="waLink" href="#" target="_blank" rel="noopener noreferrer">
            <button class="btn whatsapp" type="button">Compartir en WhatsApp</button>
          </a>

          <a id="tgLink" href="#" target="_blank" rel="noopener noreferrer">
            <button class="btn telegram" type="button">Compartir en Telegram</button>
          </a>
        </div>

        <p class="note">Asunto: <strong>"Prueba extendida de la Web con título más largo"</strong></p>
        <p class="note">Mensaje: <strong>"Este es un mensaje de prueba extendido, con más detalles, saltos de línea y texto adicional para verificar cómo se ve en distintas plataformas.%0A%0AIncluye varios párrafos y está diseñado para WhatsApp, Telegram y correo electrónico."</strong></p>
      </div>

      <!-- MAIL FORM -->
      <div class="col form-box" aria-labelledby="mailTitle">
        <h2 id="mailTitle" style="margin:0 0 10px 0;font-size:16px">Enviar correo</h2>
        <p class="meta">Escribe uno o varios destinatarios. <strong>Atajo Gmail:</strong> si escribes solo la parte antes de la @ (por ejemplo <code>tal</code>), se convertirá en <code>tal@gmail.com</code>. Esta función está diseñada específicamente para direcciones Gmail.</p>

        <form id="mailForm" onsubmit="handleSubmit(event)" novalidate>
          <label for="recipients">Destinatarios (separados por comas, punto y coma o saltos de línea)</label>
          <textarea id="recipients" rows="4" placeholder="ej: pepe, ana; juan@gmail.com" required></textarea>

          <div style="display:flex;gap:8px;align-items:center;margin-top:10px">
            <button class="btn send" type="submit">Abrir cliente para enviar</button>
          </div>

          <div id="status" class="status" role="status" aria-live="polite"></div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Asunto y cuerpo extendidos
    const FIXED_SUBJECT = "Prueba extendida de la Web con título más largo";
    const FIXED_BODY = "Este es un mensaje de prueba extendido, con más detalles, saltos de línea y texto adicional para verificar cómo se ve en distintas plataformas.\n\nIncluye varios párrafos y está diseñado para WhatsApp, Telegram y correo electrónico.";
    const FIXED_SUBJ_ENC = encodeURIComponent(FIXED_SUBJECT);
    const FIXED_BODY_ENC = encodeURIComponent(FIXED_BODY);

    // Enlaces de compartir
    document.getElementById('waLink').href = `https://api.whatsapp.com/send?text=${FIXED_BODY_ENC}`;
    document.getElementById('tgLink').href = `https://t.me/share/url?url=https://tuweb.com&text=${FIXED_SUBJECT}%0A%0A${FIXED_BODY_ENC}`;

    // --- EMAIL ---
    function splitRaw(raw) {
      if (!raw) return [];
      return raw
        .split(/[\r\n,;]+/)
        .map(s => s.trim())
        .filter(Boolean);
    }

    function normalizeEntry(entry) {
      const e = entry.trim();
      if (e === '') return '';
      if (e.includes('@')) return e.toLowerCase();
      const local = e.replace(/\s+/g, '');
      return `${local}@gmail.com`.toLowerCase();
    }

    function isValidBasicEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
      return re.test(email);
    }

    const statusEl = document.getElementById('status');
    function handleSubmit(e) {
      e.preventDefault();
      statusEl.textContent = '';
      statusEl.className = 'status';

      const raw = document.getElementById('recipients').value;
      const parts = splitRaw(raw);

      if (parts.length === 0) {
        statusEl.textContent = 'Introduce al menos un destinatario.';
        statusEl.classList.add('err');
        return;
      }

      const normalized = parts.map(normalizeEntry);
      const invalid = normalized.filter(x => !isValidBasicEmail(x));
      if (invalid.length) {
        statusEl.innerHTML = `Dirección(es) inválida(s): <strong>${invalid.join(', ')}</strong>`;
        statusEl.classList.add('err');
        return;
      }

      if (normalized.length === 1) {
        const to = normalized[0];
        const mailto = `mailto:${encodeURIComponent(to)}?subject=${FIXED_SUBJ_ENC}&body=${FIXED_BODY_ENC}`;
        statusEl.innerHTML = `Se abrirá el cliente con <strong>To:</strong> ${to}`;
        statusEl.classList.add('ok');
        window.location.href = mailto;
      } else {
        const bccList = normalized.join(',');
        const mailto = `mailto:?bcc=${encodeURIComponent(bccList)}&subject=${FIXED_SUBJ_ENC}&body=${FIXED_BODY_ENC}`;
        statusEl.innerHTML = `Se abrirá el cliente con <strong>BCC</strong> (${normalized.length} destinatarios).`;
        statusEl.classList.add('ok');
        window.location.href = mailto;
      }
    }
  </script>
</body>
</html>
