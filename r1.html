function updateGamepadStatus() {
  const gamepads = navigator.getGamepads();
  const gp = gamepads[gamepadIndex];
  if (!gp) {
    requestAnimationFrame(updateGamepadStatus);
    return;
  }

  gp.buttons.forEach((btn, index) => {
    if (btn.pressed) {
      console.log("BotÃ³n presionado: " + index);
    }
  });

  const L1 = gp.buttons[4];
  const R1 = gp.buttons[5];
  const LEFT = gp.buttons[14];

  // -------- Primer combo: L1 + R1 --------
  if (L1?.pressed && R1?.pressed) {
    if (comboStartTime === null) {
      comboStartTime = performance.now();
    } else if (performance.now() - comboStartTime >= 5000 && !comboShown) {
      document.getElementById("comboMessage").style.display = "block";
      document.getElementById("bigBox").style.display = "block";
      comboShown = true;
    }
  } else {
    comboStartTime = null;
    comboShown = false;
    document.getElementById("comboMessage").style.display = "none";
    document.getElementById("bigBox").style.display = "none";
  }

  // -------- Nuevo combo: R1 + Flecha Izquierda --------
  if (R1?.pressed && LEFT?.pressed) {
    if (!window.leftComboStartTime) {
      window.leftComboStartTime = performance.now();
    } else if (performance.now() - window.leftComboStartTime >= 5000 && !window.leftComboShown) {
      document.getElementById("extraMessage").style.display = "block";
      window.leftComboShown = true;
    }
  } else {
    window.leftComboStartTime = null;
    window.leftComboShown = false;
    document.getElementById("extraMessage").style.display = "none";
  }

  requestAnimationFrame(updateGamepadStatus);
}
