<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Select Din√°mico Avanzado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      background-color: #f9f9f9;
    }

    select {
      font-size: 16px;
      padding: 10px;
      width: 350px;
    }

    h2 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <h2>üå©Ô∏è Men√∫ din√°mico con control de orden</h2>
  <select id="dynamic-select">
    <option disabled selected>-- Selecciona una opci√≥n --</option>
    <option value="custom">üå©Ô∏è Crear opci√≥n personalizada</option>
    <option value="random">üå©Ô∏è Crear opci√≥n aleatoria</option>
  </select>

  <script>
    const select = document.getElementById('dynamic-select');
    const alertMessages = {};

    function mensajeAleatorio() {
      const mensajes = [
        "üå©Ô∏è Mensaje sorpresa ‚ö°",
        "üå©Ô∏è ¬°Qu√© buena elecci√≥n!",
        "üå©Ô∏è Este mensaje es aleatorio üé≤",
        "üå©Ô∏è Nadie esperaba esto",
        "üå©Ô∏è Boom! Una nueva opci√≥n"
      ];
      return mensajes[Math.floor(Math.random() * mensajes.length)];
    }

    select.addEventListener('change', () => {
      const valor = select.value;

      if (valor === 'custom') {
        const nombre = prompt('üå©Ô∏è ¬øCu√°l ser√° el nombre de la nueva opci√≥n personalizada?');
        if (!nombre) return;

        const mensaje = prompt('üå©Ô∏è ¬øQu√© mensaje debe mostrar esta opci√≥n?');
        if (!mensaje) return;

        const nuevaOpcion = document.createElement('option');
        const valueId = 'opt_' + Date.now();
        nuevaOpcion.value = valueId;
        nuevaOpcion.textContent = 'üå©Ô∏è ' + nombre;

        alertMessages[valueId] = mensaje;

        // Insertar debajo de la opci√≥n "custom" y antes de "random"
        const opciones = Array.from(select.options);
        const customIndex = opciones.findIndex(opt => opt.value === 'custom');
        const randomIndex = opciones.findIndex(opt => opt.value === 'random');

        // Insertamos justo despu√©s de la opci√≥n "custom" y antes de "random"
        select.add(nuevaOpcion, select.options[randomIndex]);

        select.value = valueId;
        alert(mensaje);

      } else if (valor === 'random') {
        const nombre = prompt('üå©Ô∏è ¬øCu√°l ser√° el nombre de esta opci√≥n aleatoria?');
        if (!nombre) return;

        const mensaje = mensajeAleatorio();
        const nuevaOpcion = document.createElement('option');
        const valueId = 'opt_' + Date.now();
        nuevaOpcion.value = valueId;
        nuevaOpcion.textContent = 'üå©Ô∏è ' + nombre;

        alertMessages[valueId] = mensaje;

        // Insertar justo despu√©s de la opci√≥n "random"
        const opciones = Array.from(select.options);
        const randomIndex = opciones.findIndex(opt => opt.value === 'random');

        // Si hay ya opciones aleatorias, insertamos al final despu√©s de ellas
        let insertIndex = randomIndex + 1;
        while (insertIndex < select.options.length && select.options[insertIndex].value.startsWith("opt_")) {
          insertIndex++;
        }

        select.add(nuevaOpcion, select.options[insertIndex] || null);
        select.value = valueId;
        alert(mensaje);

      } else if (alertMessages[valor]) {
        alert(alertMessages[valor]);
      }

      // Volver a la opci√≥n por defecto si fue "crear"
      if (valor === 'custom' || valor === 'random') {
        select.value = '-- Selecciona una opci√≥n --';
      }
    });
  </script>

</body>
</html>
